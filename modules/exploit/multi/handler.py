#######
# Module/Exploit: Multi Handler
#######

from libs.terasploit.framework.opts.opt_container import *
from libs.terasploit.framework.info.info_container import *
from libs.terasploit.framework.module.exploit import *

class TerasploitModule(Exploit):

    def initialize(self,info_only: bool = False) -> None:
        update_info (
            {
                'Name'     : 'multi handler',
                'Module'   : Module.exploit,
                "Platform" : Platform.MULTI,
                "Arch"     : Arch.MULTI,
                'Payload'  : 'modules/payload/php/reverse_tcp',
                'Author'  : [
                    'Charlie <rupture6.dev[at]gmail.com>'
                ],
                'Description' : [
                    'Exploit module that executes payload features only.',
                    'It exploits the target by connecting on payload that',
                    "is already planted on the target's device."
                ],
            }
        )

        if info_only:
            return

        register_option (module="exploit",reset=True)

    def exploit(self) -> tuple[str, bool]: 
        return 'session', True
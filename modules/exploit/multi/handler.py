#######
# Module/Exploit: Multi Handler
#######

from libs.terasploit.framework.opts.opt_container import *
from libs.terasploit.framework.info.info_container import *
from libs.terasploit.framework.module.exploit import *

class TerasploitExploit(Exploit):
    
    module_type = 'exploit'
    payload = 'modules/payload/php/multi/reverse_tcp'
    
    def initialize(self,info_only: bool = False) -> None:
        update_info (
            {
                'Module' : 'exploit',
                'Name' : 'multi handler',
                'Author' : 'Handler4',
            
                'Description' : [
                    'Exploit module that executes payload features only.',
                    'It exploits the target by connecting on payload that',
                    "is already planted on target's device."
                ]
            }
        )

        if info_only:
            return

        register_option (module="exploit",reset=True)

    def exploit(self) -> tuple[str, bool]: 
        return 'session', True